{
  "hash": "d3ae0afd8acd18c2c6066e787ccffeca",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: Otros Modelos de Series de Tiempo No lineales\nsubtitle: Descubre cómo seleccionar hardware, descargar la imagen ISO y preparar los medios de instalación. Exploraremos opciones para probar o instalar Linux en tu equipo.\ndescription: |\n  Únete a esta emocionante serie de introducción a Linux, donde te guiaré a través de los pasos para descargar e instalar GNU/Linux en tu equipo. Aprenderás a seleccionar el hardware adecuado, descargar la imagen ISO de tu distribución preferida y preparar los medios de instalación. Además, exploraremos diferentes opciones para probar o instalar Linux. ¡Embárcate en esta aventura y descubre el poder de GNU/Linux!\ncategories:\n  - Informática\n  - Tecnología\n  - Sistemas Operativos\n  - Linux\ntags:\n  - Linux\n  - OpenSource\n  - GNU/Linux\n  - SistemasOperativos\n  - DistribucionesLinux\n  - DescargaDeLinux\n  - InstalaciónDeLinux\n  - Hardware\n  - ImagenISO\ndate: \"08/27/2023\"\n---\n\n\n\n\n\n\n# Otros Modelos de Series de Tiempo No lineales\n\n## Modelos de cambio de régimen\n\nEn años recientes, los modelos de serie de tiempo han sido incorporados en análisis de la existencia de diferentes estados que son generados por procesos estocásticos subyacentes. En esta sección del curso revisaremos algunos modelos de cambio de regimen. Restringimos nuestra revisión a modelos que asuman que la dinámica de las series puede ser descrito por modelos del tipo AR y dejamos fuera procesos del tipo MA.\n\nEn general distinguimos que existen dos tipos de modelos:\n\\begin{enumerate}\n    \\item Modelos caracterizados por una variable observable, por lo que tenemos certeza de los régimanes en cada uno de los momentos.\n    \n    \\item Modelos en los que el régimen no puede ser observado por una variable, pero si conocemos el proceso estocástico subyacente. \n\\end{enumerate}\n\n### Regímenes determinados por información observable\n\nEn estos casos asumimos que el régimen ocurren en un momento $t$ y puede ser determinado por una variable observable. Este modelo es conocido como el modelo autoregresivo con umbral (TAR, Threshold Autoregressive model). En este caso también diremos que cuando el régimen está determinado por la información de la misma serie será llamdao Self-Exciting TAR (SETAR).\n\nVeámos un ejemplo. Supongamos que existe un umbral, $c$, para el régimen que esta determinado por $q_t = y_{t-1}$ y que el estado de la naturaleza nos permite establecer dos estados o regímenes:\n\\begin{equation}\n    y_t = \n    \\begin{cases}\n        \\phi_{01} + \\phi_{11} y_{t-1} + \\varepsilon_t \\text{ si } y_{t-1} \\leq c \\\\\n        \\phi_{02} + \\phi_{12} y_{t-1} + \\varepsilon_t \\text{ si } y_{t-1} > c \n    \\end{cases}\n\\end{equation}\n\nDonde asumiremos que $\\varepsilon_t$ es i.i.d y que cumple con:\n\\begin{equation*}\n    \\mathbb{E}[\\varepsilon_t | \\Omega_{t-1}] = 0\n\\end{equation*}\n\nDonde $\\Omega_{t-1} = \\{ y_{t-1}, y_{t-2}, \\ldots \\}$. Existe una variante de este modelo que suaviza la transición entre regímenes conocido como Smooth Transition AR (STAR) y puede ser especificado en su modalidad de dos regémenes como:\n\\begin{equation}\n    y_t = (\\phi_{01} + \\phi_{11} y_{t-1}) (1 - G(y_{t-1}; \\gamma, c)) + (\\phi_{02} + \\phi_{12} y_{t-1}) G(y_{t-1}; \\gamma, c) + \\varepsilon_t\n\\end{equation}\n\nDonde $G(y_{t-1}; \\gamma, c)$ es una función de distribución de probabilidad que suviza la transición entre regímenes. La práctica común es suponer que está tiene una forma logística:\n\\begin{equation}\n    G(y_{t-1}; \\gamma, c) = \\frac{1}{1 + e^{-\\gamma (y_{t-1} - c)}}\n\\end{equation}\n\nEs posible hacer estensiones de lo anterior a modelos de orden superior dando como resultado:\n\\begin{equation}\n    y_t = \n    \\begin{cases}\n        \\phi_{01} + \\phi_{11} y_{t-1} + \\phi_{21} y_{t-2} + \\ldots + \\phi_{p_1 1} y_{t-p_1} + \\varepsilon_t \\text{ si } y_{t-1} \\leq c \\\\\n        \\phi_{02} + \\phi_{12} y_{t-1} + \\phi_{22} y_{t-2} + \\ldots + \\phi_{p_2 2} y_{t-p_2} + \\varepsilon_t \\text{ si } y_{t-1} > c \n    \\end{cases}\n\\end{equation}\n\nEn el segundo caso:\n\\begin{eqnarray*}\n    y_t & = & (\\phi_{01} + \\phi_{11} y_{t-1} + \\phi_{21} y_{t-2} + \\ldots + \\phi_{p_1 1} y_{t-p_1}) (1 - G(y_{t-1}; \\gamma, c)) \\\\\n    &  & + (\\phi_{02} + \\phi_{12} y_{t-1} + \\phi_{22} y_{t-2} + \\ldots + \\phi_{p_2 2} y_{t-p_2}) G(y_{t-1}; \\gamma, c) \\\\\n    &  & + \\varepsilon_t\n\\end{eqnarray*}\n\nDe igual forma que en el caso de los modelos ARIMA y VAR, el número de rrezagos utilizados es determinado mediennte el uso de criterios de información como el de Akaike:\n\\begin{equation}\n    AIC(p_1, p_2) = n_1 ln(\\hat{\\sigma}^2_1) + n_2 ln(\\hat{\\sigma}^2_2) + 2(p_1 + 1) + 2(p_2 + 1)\n\\end{equation}\n\nLos modelos SETAR y STAR generan procesos estacionarios siempre que cumplan ciertas condiciones. En estas notas nos enfocaremos únicamente en el modelo SETAR el cual genera en un proceso estacionario cuando:\n\\begin{enumerate}\n    \\item $\\phi_{11} < 1$, $\\phi_{12} < 1$, $\\phi_{11} \\cdot \\phi_{12} < 1$\n    \n    \\item $\\phi_{11} = 1$, $\\phi_{12} < 1$, $\\phi_{01} > 0$\n    \n    \\item $\\phi_{11} < 1$, $\\phi_{12} = 1$, $\\phi_{02} < 0$\n    \n    \\item $\\phi_{11} = 1$, $\\phi_{12} = 1$, $\\phi_{02} < 0 < \\phi_{01}$\n    \n    \\item $\\phi_{11} \\cdot \\phi_{12} = 1$, $\\phi_{11} < 0$, $\\phi_{02} + \\phi_{12} \\cdot \\phi_{01} > 0$\n\\end{enumerate}\n\nFinalmente, en ocasiones podemos estar interesados en modelos donde los regímenes sean más de 2, es decir, digamos $m$ umbrales bajo un modelo SETAR o STAR. Por ejemplo, en el caso de un modelo SETAR podemos verificar que $m$ regímnes implican $m + 1$ umbrales: $c_0, c_1, \\ldots, c_m$. En cuyo caso:\n\\begin{equation*}\n    -\\infty = c_0 < c_1 < \\ldots < c_{m-1} < c_m = \\infty\n\\end{equation*}\n\nAsí, tendríamos ecuaciones:\n\\begin{equation}\n    y_t = \\phi_{0j} + \\phi_{ij} y_{t-1} + \\varepsilon_t \\text{ si } c_{j-1} < y_{t-1} < c_j\n\\end{equation}\n\nPara $j = 1, 2, \\ldots, m$. De forma similar podemos recomponer el modelo STAR.\n\n### Regímenes determinados por variables no observables\n\nEste tipo de modelosmasume que el regímen ocurre en el momento $t$ y que no puede ser observado, ya que este es determinado por un proceso no observable, el cual denotamos como $s_t$. En el caso de dos regímenes, $s_t$ puede ser asumido como que toma 2 valores: 1 y 2, por ejemplo. Supongamos que el proceso subyacente tiene una forma del tipo AR(1) dado por:\n\\begin{equation}\n    y_t = \n    \\begin{cases}\n        \\phi_{01} + \\phi_{11} y_{t-1} + \\varepsilon_t \\text{ si } s_t = 1 \\\\\n        \\phi_{02} + \\phi_{12} y_{t-1} + \\varepsilon_t \\text{ si } s_t = 2\n    \\end{cases}\n    \\label{eq_swching_obs}\n\\end{equation}\n\nO en un formato más corto de notación:\n\\begin{equation}\n    y_t = \\phi_{0 s_t} + \\phi_{1 s_t} y_{t-1} + \\varepsilon_t\n\\end{equation}\n\nPara complementar el modelo, las propiedades del proceso $s_t$ necesitan ser especificadas. El modelo más popular dentro de esta familia es el propuesto por James Hamilton en 1989 el cual es conocido como Markov Switching Model (MSM), en el cual el proceso $s_t$ se asume como un proceso de Markov de primer orden. Esto implica que el regímen actula $s_t$ sólo dependen del período $s_{t-1}$. \n\nAsí, el modelo es completado mediante la definición de las probabilidades de transición para moverse del un estado a otro:\n\\begin{eqnarray*}\n    \\mathbb{P}(s_t = 1 | s_{t-1} = 1) & = & p_{11} \\\\\n    \\mathbb{P}(s_t = 2 | s_{t-1} = 1) & = & p_{12} \\\\\n    \\mathbb{P}(s_t = 1 | s_{t-1} = 2) & = & p_{21} \\\\\n    \\mathbb{P}(s_t = 2 | s_{t-1} = 2) & = & p_{22} \n\\end{eqnarray*}\n\nAsí, $p_{ij}$ es igual a la probabilidad de que la cadena de Markov pase del estado $i$ en el momento $t-1$ al estdo $j$ en el tiempo $t$. En todo caso asumiremos que $p_{ij} > 0$ y que:\n\\begin{eqnarray*}\n    p_{11} + p_{12} = 1 \\\\\n    p_{21} + p_{22} = 1 \n\\end{eqnarray*}\n\nOtro tipo de probabilidades a analizar son las probabilidades incondicionales de $\\mathbb{P}(s_t = i)$, $i = 1, 2$. Usando la teoría ergódica de la cadenas de Markov, estas probabilidades están dadas por:\n\\begin{eqnarray*}\n    \\mathbb{P}(s_t = 1) & = & \\frac{1 - p_{22}}{2 - p_{11} - p_{22}} \\\\ \n    \\mathbb{P}(s_t = 2) & = & \\frac{1 - p_{11}}{2 - p_{11} - p_{22}}\n\\end{eqnarray*}\n\nUn caso más general es el de múltiples regímenes en el cual $s_t$ puede tomar cualquier valor $m > 2$, $m \\in \\mathbb{N}$. Este modelo se puede escribir como:\n\\begin{equation}\n    y_t = \\phi_{0j} + \\phi_{1j} y_{t-1} + \\varepsilon_t \\text{ si } s_t = j \\text{, para } j = 1, 2, \\ldots, m\n\\end{equation}\n\nDonde las probabilidades de transición estarán dadas por:\n\\begin{equation}\n    p_{ij} = \\mathbb{P}(s_t = j | s_{t-1} = i) \\text{ para } i , j = 1, 2, \\ldots, m\n\\end{equation}\n\nDonde la ecuación anterior satisface que $p_{ij} > 0$, $\\forall i, j = = 1, 2, \\ldots, m$ y que:\n\\begin{equation*}\n    \\sum_{j=1}^m p_{ij} = 1 \\text{ para } i = 1, 2, \\ldots, m\n\\end{equation*}\n\nFinalmente, plantearemos el procedimiento empiríco seguido para la estimación de este tipo de modelos:\n\\begin{enumerate}\n    \\item Estimar un proceso AR(p)\n    \n    \\item Probar una hipótesis nula de no linealidad de acurdo con alguno de los modelos SERAR, STAR o MSM\n    \n    \\item Estimar lo parámetros\n    \n    \\item Evluar los resultados del modelo\n    \n    \\item Ajustar, en su caso, la estimación o modelo\n    \n    \\item Pronósticar o realizar análisis impluso-respuesta\n\\end{enumerate}\n\n## Ejemplo: Modelos de Cambio de Regímen (TAR)\n\nDependencies and Setup:\n\n\n\n\n\n\n\n\n\n\n\n\n\nData: Monthly rates of deaths due to flu in the United States for 11 years\n\n\n\n\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\n  X.8113721\n1 0.4458291\n2 0.3415985\n3 0.2774243\n4 0.2484958\n5 0.2525427\n6 0.2466902\n```\n\n\n:::\n:::\n\n\n\n\n\n\nConvert time series\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nflu <- ts(flu)\n\nD_flu = diff(flu, lag = 1)\n```\n:::\n\n\n\n\n\n\nPlotting\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(flu, type = \"b\", col = \"darkred\", ylab = \"\", \n     main = \"Monthly rates of deaths due to flu in the United States\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n\n```{.r .cell-code}\nplot(D_flu, type=\"b\", col = \"darkred\", ylab = \"\", \n     main = \"Diff Monthly rates of deaths due to flu in the United States\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-3-2.png){width=672}\n:::\n:::\n\n\n\n\n\n\nThe tsDyn package in R has simplified this code into a handful of steps:\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#?setar\n\nD_flu_tar4_05 <- setar(D_flu, m = 4, thDelay = 0, th = 0.05) \n\nsummary(D_flu_tar4_05) \n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nNon linear autoregressive model\n\nSETAR model ( 2 regimes)\nCoefficients:\nLow regime:\n     const.L       phiL.1       phiL.2       phiL.3       phiL.4 \n 0.004432028  0.501179574 -0.206693004  0.120140800 -0.122254140 \n\nHigh regime:\n   const.H     phiH.1     phiH.2     phiH.3     phiH.4 \n 0.4079353 -0.7483325 -1.0323129 -2.0450407 -6.7117769 \n\nThreshold:\n-Variable: Z(t) = + (1) X(t)+ (0)X(t-1)+ (0)X(t-2)+ (0)X(t-3)\n-Value: 0.05 (fixed)\nProportion of points in low regime: 86.51% \t High regime: 13.49% \n\nResiduals:\n       Min         1Q     Median         3Q        Max \n-0.1319314 -0.0217073  0.0015801  0.0196093  0.2674245 \n\nFit:\nresiduals variance = 0.002166,  AIC = -778, MAPE = 412.4%\n\nCoefficient(s):\n\n          Estimate  Std. Error  t value  Pr(>|t|)    \nconst.L  0.0044320   0.0051791   0.8558 0.3938357    \nphiL.1   0.5011796   0.0833821   6.0106 2.043e-08 ***\nphiL.2  -0.2066930   0.0608839  -3.3949 0.0009313 ***\nphiL.3   0.1201408   0.0576505   2.0839 0.0392868 *  \nphiL.4  -0.1222541   0.0522363  -2.3404 0.0209137 *  \nconst.H  0.4079353   0.0314121  12.9866 < 2.2e-16 ***\nphiH.1  -0.7483325   0.1118329  -6.6915 7.455e-10 ***\nphiH.2  -1.0323129   0.1420203  -7.2688 4.018e-11 ***\nphiH.3  -2.0450407   0.7055163  -2.8986 0.0044573 ** \nphiH.4  -6.7117769   0.8367945  -8.0208 7.911e-13 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nThreshold\nVariable: Z(t) = + (1) X(t) + (0) X(t-1)+ (0) X(t-2)+ (0) X(t-3)\n\nValue: 0.05 (fixed)\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(D_flu_tar4_05)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-5-2.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-5-3.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-5-4.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-5-5.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-5-6.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-5-7.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-5-8.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-5-9.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-5-10.png){width=672}\n:::\n:::\n\n\n\n\n\n\nIf we do not provide a threshold to the th option, setar searches over a grid to choose a threshold ~ 0.038:\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nD_flu_tar4 <- setar(D_flu, m = 4, thDelay = 0)\n\nsummary(D_flu_tar4)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nNon linear autoregressive model\n\nSETAR model ( 2 regimes)\nCoefficients:\nLow regime:\n      const.L        phiL.1        phiL.2        phiL.3        phiL.4 \n-6.287604e-05  4.464075e-01 -2.315888e-01  1.070141e-01 -1.440609e-01 \n\nHigh regime:\n   const.H     phiH.1     phiH.2     phiH.3     phiH.4 \n 0.3486150 -0.5903335 -1.0318488 -2.4053812 -4.8052422 \n\nThreshold:\n-Variable: Z(t) = + (1) X(t)+ (0)X(t-1)+ (0)X(t-2)+ (0)X(t-3)\n-Value: 0.03798\nProportion of points in low regime: 84.92% \t High regime: 15.08% \n\nResiduals:\n      Min        1Q    Median        3Q       Max \n-0.277686 -0.020554  0.005116  0.020762  0.119627 \n\nFit:\nresiduals variance = 0.002405,  AIC = -762, MAPE = 372.5%\n\nCoefficient(s):\n\n           Estimate  Std. Error  t value  Pr(>|t|)    \nconst.L -6.2876e-05  5.5723e-03  -0.0113 0.9910158    \nphiL.1   4.4641e-01  8.9159e-02   5.0068 1.921e-06 ***\nphiL.2  -2.3159e-01  6.4329e-02  -3.6001 0.0004636 ***\nphiL.3   1.0701e-01  6.1034e-02   1.7534 0.0820953 .  \nphiL.4  -1.4406e-01  5.5198e-02  -2.6099 0.0102109 *  \nconst.H  3.4862e-01  2.7460e-02  12.6954 < 2.2e-16 ***\nphiH.1  -5.9033e-01  1.0988e-01  -5.3724 3.869e-07 ***\nphiH.2  -1.0318e+00  1.4957e-01  -6.8987 2.641e-10 ***\nphiH.3  -2.4054e+00  6.9134e-01  -3.4793 0.0007014 ***\nphiH.4  -4.8052e+00  8.2824e-01  -5.8017 5.451e-08 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nThreshold\nVariable: Z(t) = + (1) X(t) + (0) X(t-1)+ (0) X(t-2)+ (0) X(t-3)\n\nValue: 0.03798\n```\n\n\n:::\n\n```{.r .cell-code}\nplot(D_flu_tar4)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-6-2.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-6-3.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-6-4.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-6-5.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-6-6.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-6-7.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-6-8.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-6-9.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-6-10.png){width=672}\n:::\n:::",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}